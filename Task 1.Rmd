---
title: "Practice Task 1"
author: "Richard"
date: "2023-03-20"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Problem 1}
# required packages
# library(readr)
# library(tidyr)
# library(dplyr)

pacman::p_load(dplyr,readr,tidyr,readxl,ggplot2,skimr,gtExtras)

# dt <- readxl::read_excel("refine_original_toy_data.xlsx")[1]
# dt <- dt[,1] %>%
# separate(sep = ",")

dt <- read_csv("refine_original_toy_data_csv.csv")
# unique(dt$)
```

```{r Problem 2}
dt <- dt %>%
    mutate(company = ifelse(grepl("^phil|^fil|^phl", company,
        ignore.case = TRUE), "philips", company)) %>%
    mutate(company = ifelse(grepl("^ak", company, ignore.case = TRUE),
        "akzo", company)) %>%
    mutate(company = ifelse(grepl("^van", company, ignore.case = TRUE),
        "van_houten", company)) %>%
    mutate(company = ifelse(grepl("^uni", company, ignore.case = TRUE),
        "unilever", company))
```

```{r Problem 3}
dt <- dt %>%
    separate(`Product code / number`, into = c("product_code",
        "Product_number"), sep = "-")
```

```{r Problem 4}
dt <- dt %>%
    mutate(product_category = ifelse(product_code == "p", "Smartphone",
        "")) %>%
    mutate(product_category = ifelse(product_code == "x", "Laptop",
        product_category)) %>%
    mutate(product_category = ifelse(product_code == "v", "TV",
        product_category)) %>%
    mutate(product_category = ifelse(product_code == "q", "Tablet",
        product_category))
```

```{r Problem 5}
dt <- dt %>%
    unite(full_address, c(address, city, country), sep = ",")
```

```{r Problem 6}
dt <- dt %>%
    mutate(company_philips = ifelse(company == "philips", 1,
        0)) %>%
    mutate(company_akzo = ifelse(company == "akzo", 1, 0)) %>%
    mutate(company_van_houten = ifelse(company == "van_houten",
        1, 0)) %>%
    mutate(company_unilever = ifelse(company == "unilever", 1,
        0))
```

```{r Problem 7}
dt <- dt %>%
    mutate(product_smartphone = ifelse(product_category == "Smartphone",
        1, 0)) %>%
    mutate(product_TV = ifelse(product_category == "TV", 1, 0)) %>%
    mutate(product_laptop = ifelse(product_category == "Laptop",
        1, 0)) %>%
    mutate(product_tablet = ifelse(product_category == "Tablet",
        1, 0))
```

```{r Working with Data}
# install th read r package
# install.packages(readr)
# load the read r package
library(readr)
# read csv file using read.table()
df1 <- read_csv("demo csv data.csv", show_col_types = FALSE)
# df1 <- read_csv("data/demo csv data.csv", show_col_types = FALSE)
# read txt file that doesnot headers
library(dplyr)
df2 <- read_delim("demo data text.txt")
# df2 <- read_delim("data/demo data text.txt")
# Or use
df3 <- read_tsv("demo data text.txt") 
View(df3)

# df3 <- read_tsv("data/demo data text.txt")

# utils:: Package

#Importing an Excel file
# install package
install.packages("readxl")
# load package
library(readxl)
# by default, it loads the first sheet
excel_data <- read_excel("demo excel data.xlsx") 
View(excel_data)
# excel_data <- read_excel("data/demo excel data.xlsx")
# if the excell workbook has many sheets and you want to
# load a specific one, e,g, sheet two
excel_data <- read_excel("demo excel data.xlsx", sheet = 2)

#Importing a Stata file
install.packages("readstata13")
library(readstata13)
stata_data <- read.dta13("demo stata data.dta", generate.factors = TRUE)
View(stata_data)
# stata_data <- read.dta13("data/demo stata data.dta", generate.factors = TRUE)

#Importing an R data file
load("demo R data.rda")

#Inbuilt Data sets
# Loading
data(mtcars)
# learn more about the data
`?`(mtcars)
# OR
help(mtcars)
# list available datasets in ggplot2 package
pacman::p_load(ggplot2)
data(package = "ggplot2")

# For a better visual display of the results, additional packages can be used such as skimr, gtsummary, kable, 
install.packages("skimr")
library(skimr)
# get the summary of all the variable, alternative to str()
View(iris)
skim(iris)

sales_report <- readr::read_csv("sales_data.csv")
sales_report

skim(sales_report)

write.csv(sales_report, file = "C:/Users/RichardLubega/Downloads/R Projects/Exported Files/my_data.csv")  # exporting csv data file

```

```{r Task 1}
summary(sales_report)

# Load a new data file named “customer_data.xlsx” into RStudio.
excel_file <- readxl::read_xlsx("demo excel data.xlsx")
skim(excel_file)

head(excel_file, n=13)
?tibble
tail(excel_file)

str(excel_file)

summary(excel_file)

pacman::p_load(writexl)
writexl::write_xlsx()

writexl::write_xlsx(excel_file, path ="C:/Users/RichardLubega/Downloads/R Projects/Exported Files/my_data.xlsx")

writexl::write_xlsx(excel_file,path = "my_data.xlsx")

# writexl::write_xlsx(data_object, file = "my_data.rda") #exporting excel data file
```

```{r Task 2}
data(iris)
?iris
flower_data <- iris
# Using the “plot” function, create a scatter plot of the “Sepal.Length” and “Sepal.Width” columns in the “iris” object.
plot(x= flower_data$Sepal.Length, y=flower_data$Sepal.Width)

# Using the “boxplot” function, create a box plot of the “Petal.Length” column in the “iris” object, grouped by the “Species” column.
boxplot(flower_data$Petal.Length,flower_data$Species)
library(dplyr)
boxplot(x = flower_data$Sepal.Length)

library(ggplot2)

flower_data %>% 
  ggplot()+ aes(x = Species, y = Sepal.Length)+
  geom_boxplot()

plot()

?boxplot

# Using the “hist” function, create a histogram of the “Petal.Width” column in the “iris” object, grouped by the “Species” column.
group_by(flower_data)=flower_data$Species
hist(x= flower_data$Petal.Width)

# Using the “plot” function, create a line plot of the “Sepal.Length” column in the “iris” object, grouped by the “Species” column.


```

```{r Data Wrangling Packages}
# A dataset from the ggplot2 package called msleep.
data_set1 <- msleep

skimr::skim(data_set1)

?msleep
data()
data(package="ggplot2")

glimpse(data_set1)
summary(data_set1)

#Filtering Rows
filter(data_set1,data_set1$order == "Primates")

data_set1 %>% 
  filter(data_set1$order =="Primates")
data_set1 %>%
  filter(order == "Primates" & sleep_total > 10)

# Filtering Columns
data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_total, sleep_rem, sleep_cycle)

data_set1 %>% #Renaming columns
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, total = sleep_total, rem = sleep_rem, cycle = sleep_cycle)

data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    rename(total = sleep_total, rem = sleep_rem, cycle = sleep_cycle)

# Reordering Columns
data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total)

# Reordering Rows
data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total) %>%
    arrange(sleep_total)# ordering in ascending order

data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total) %>%
    arrange(desc(sleep_total)) #Ordering in descending order

data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total) %>%
    arrange(name) #can also be used to order non-numeric variables. 

data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total) %>%
    arrange(name, sleep_total)# reorder rows based on information in multiple columns

#Creating New Columns
data_set1 %>%
    filter(order == "Primates", sleep_total > 10) %>%
    select(name, sleep_rem, sleep_cycle, sleep_total) %>%
    arrange(name) %>%
    mutate(sleep_total_min = sleep_total * 60) #we can create a new column


#Statistics in R
gtExtras::gt_plt_summary(data_set1)

t.test(data_set1$sleep_total, mu = 10)

t.test(data_set1$sleep_total, mu = 13, alternative = "greater", conf.level = .98)

wilcox.test(data_set1$sleep_total, mu = 13)

qqnorm(data_set1$sleep_total)
qqline(data_set1$sleep_total, lty = 2)

shapiro.test(data_set1$sleep_total)


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
